{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "ASH Cross-SDK Test Vectors",
  "version": "1.0.0",
  "description": "Standard test vectors for verifying ASH SDK interoperability",

  "canonicalization": {
    "description": "JSON canonicalization test vectors (RFC 8785 JCS)",
    "vectors": [
      {
        "id": "canon-001",
        "description": "Simple object key sorting",
        "input": "{\"z\":1,\"a\":2}",
        "expected": "{\"a\":2,\"z\":1}"
      },
      {
        "id": "canon-002",
        "description": "Nested object key sorting",
        "input": "{\"b\":{\"z\":1,\"a\":2},\"a\":3}",
        "expected": "{\"a\":3,\"b\":{\"a\":2,\"z\":1}}"
      },
      {
        "id": "canon-003",
        "description": "Array preservation (no sorting)",
        "input": "{\"arr\":[3,1,2]}",
        "expected": "{\"arr\":[3,1,2]}"
      },
      {
        "id": "canon-004",
        "description": "Whitespace removal",
        "input": "{ \"a\" : 1 , \"b\" : 2 }",
        "expected": "{\"a\":1,\"b\":2}"
      },
      {
        "id": "canon-005",
        "description": "Unicode NFC normalization",
        "input": "{\"caf√©\":\"na√Øve\"}",
        "expected": "{\"caf√©\":\"na√Øve\"}"
      },
      {
        "id": "canon-006",
        "description": "Number normalization - no trailing zeros",
        "input": "{\"n\":1.0}",
        "expected": "{\"n\":1}"
      },
      {
        "id": "canon-007",
        "description": "Number normalization - no leading zeros",
        "input": "{\"n\":0.5}",
        "expected": "{\"n\":0.5}"
      },
      {
        "id": "canon-008",
        "description": "Negative zero becomes zero",
        "input": "{\"n\":-0}",
        "expected": "{\"n\":0}"
      },
      {
        "id": "canon-009",
        "description": "Boolean and null values",
        "input": "{\"t\":true,\"f\":false,\"n\":null}",
        "expected": "{\"f\":false,\"n\":null,\"t\":true}"
      },
      {
        "id": "canon-010",
        "description": "Empty object",
        "input": "{}",
        "expected": "{}"
      },
      {
        "id": "canon-011",
        "description": "Empty array",
        "input": "{\"arr\":[]}",
        "expected": "{\"arr\":[]}"
      },
      {
        "id": "canon-012",
        "description": "Deeply nested structure",
        "input": "{\"a\":{\"b\":{\"c\":{\"z\":1,\"a\":2}}}}",
        "expected": "{\"a\":{\"b\":{\"c\":{\"a\":2,\"z\":1}}}}"
      },
      {
        "id": "canon-013",
        "description": "String escaping - quotes",
        "input": "{\"s\":\"hello \\\"world\\\"\"}",
        "expected": "{\"s\":\"hello \\\"world\\\"\"}"
      },
      {
        "id": "canon-014",
        "description": "String escaping - backslash",
        "input": "{\"s\":\"path\\\\to\\\\file\"}",
        "expected": "{\"s\":\"path\\\\to\\\\file\"}"
      },
      {
        "id": "canon-015",
        "description": "String escaping - control characters",
        "input": "{\"s\":\"line1\\nline2\\ttab\"}",
        "expected": "{\"s\":\"line1\\nline2\\ttab\"}"
      },
      {
        "id": "canon-016",
        "description": "Large integer",
        "input": "{\"n\":9007199254740991}",
        "expected": "{\"n\":9007199254740991}"
      },
      {
        "id": "canon-017",
        "description": "Scientific notation normalization",
        "input": "{\"n\":1e10}",
        "expected": "{\"n\":10000000000}"
      },
      {
        "id": "canon-018",
        "description": "Mixed array types",
        "input": "{\"arr\":[1,\"two\",true,null]}",
        "expected": "{\"arr\":[1,\"two\",true,null]}"
      },
      {
        "id": "canon-019",
        "description": "Unicode emoji",
        "input": "{\"emoji\":\"üëç\"}",
        "expected": "{\"emoji\":\"üëç\"}"
      },
      {
        "id": "canon-020",
        "description": "Real-world payload - transfer",
        "input": "{\"amount\":100.50,\"currency\":\"USD\",\"to\":\"account123\",\"memo\":\"Payment\"}",
        "expected": "{\"amount\":100.5,\"currency\":\"USD\",\"memo\":\"Payment\",\"to\":\"account123\"}"
      }
    ]
  },

  "urlencoded_canonicalization": {
    "description": "URL-encoded form data canonicalization test vectors",
    "vectors": [
      {
        "id": "url-001",
        "description": "Simple key sorting",
        "input": "z=1&a=2",
        "expected": "a=2&z=1"
      },
      {
        "id": "url-002",
        "description": "Duplicate keys preserved in order",
        "input": "a=1&b=2&a=3",
        "expected": "a=1&a=3&b=2"
      },
      {
        "id": "url-003",
        "description": "Percent encoding normalization",
        "input": "name=John%20Doe",
        "expected": "name=John%20Doe"
      },
      {
        "id": "url-004",
        "description": "Plus sign as literal (not space)",
        "input": "q=a+b",
        "expected": "q=a%2Bb"
      },
      {
        "id": "url-005",
        "description": "Empty value",
        "input": "key=",
        "expected": "key="
      },
      {
        "id": "url-006",
        "description": "Key without value",
        "input": "flag",
        "expected": "flag="
      }
    ]
  },

  "binding_normalization": {
    "description": "HTTP binding normalization test vectors (v2.3.2+ format)",
    "vectors": [
      {
        "id": "bind-001",
        "description": "Basic binding",
        "method": "POST",
        "path": "/api/users",
        "query": "",
        "expected": "POST|/api/users|"
      },
      {
        "id": "bind-002",
        "description": "Method uppercasing",
        "method": "post",
        "path": "/api/users",
        "query": "",
        "expected": "POST|/api/users|"
      },
      {
        "id": "bind-003",
        "description": "Trailing slash removal",
        "method": "GET",
        "path": "/api/users/",
        "query": "",
        "expected": "GET|/api/users|"
      },
      {
        "id": "bind-004",
        "description": "Duplicate slash collapse",
        "method": "PUT",
        "path": "/api//users///profile",
        "query": "",
        "expected": "PUT|/api/users/profile|"
      },
      {
        "id": "bind-005",
        "description": "Root path preserved",
        "method": "GET",
        "path": "/",
        "query": "",
        "expected": "GET|/|"
      },
      {
        "id": "bind-006",
        "description": "Query string sorting",
        "method": "GET",
        "path": "/api/search",
        "query": "z=3&a=1&b=2",
        "expected": "GET|/api/search|a=1&b=2&z=3"
      },
      {
        "id": "bind-007",
        "description": "Query string with duplicate keys",
        "method": "GET",
        "path": "/api/filter",
        "query": "tag=b&tag=a&sort=name",
        "expected": "GET|/api/filter|sort=name&tag=b&tag=a"
      }
    ]
  },

  "hash_body": {
    "description": "Body hashing test vectors (SHA-256)",
    "vectors": [
      {
        "id": "hash-001",
        "description": "Simple JSON body",
        "input": "{\"a\":1}",
        "expected": "7f83b1657ff1fc53b92dc18148a1d65dfc2d4b1fa3d677284addd200126d9069"
      },
      {
        "id": "hash-002",
        "description": "Empty string",
        "input": "",
        "expected": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      },
      {
        "id": "hash-003",
        "description": "Canonical transfer payload",
        "input": "{\"amount\":100,\"to\":\"account123\"}",
        "expected": "a7ffc6f8bf1ed76651c14756a061d662f580ff4de43b49fa82d80a4b80f8434a"
      }
    ]
  },

  "derive_client_secret": {
    "description": "Client secret derivation test vectors (v2.1)",
    "vectors": [
      {
        "id": "secret-001",
        "description": "Standard derivation",
        "nonce": "abc123def456",
        "contextId": "ash_ctx_001",
        "binding": "POST|/api/transfer|",
        "expected": "a1b2c3d4e5f6..."
      }
    ],
    "note": "Expected values are implementation-dependent HMAC outputs"
  },

  "proof_generation_v21": {
    "description": "v2.1 proof generation test vectors",
    "vectors": [
      {
        "id": "proof-001",
        "description": "Standard proof generation",
        "clientSecret": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",
        "timestamp": "1706400000000",
        "binding": "POST|/api/transfer|",
        "bodyHash": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
        "note": "Verify all SDKs produce identical proof for same inputs"
      }
    ]
  },

  "timing_safe_equal": {
    "description": "Constant-time comparison test vectors",
    "vectors": [
      {
        "id": "time-001",
        "a": "abc123",
        "b": "abc123",
        "expected": true
      },
      {
        "id": "time-002",
        "a": "abc123",
        "b": "abc124",
        "expected": false
      },
      {
        "id": "time-003",
        "a": "abc123",
        "b": "abc12",
        "expected": false
      },
      {
        "id": "time-004",
        "a": "",
        "b": "",
        "expected": true
      },
      {
        "id": "time-005",
        "a": "abc",
        "b": "xyz",
        "expected": false
      }
    ]
  },

  "scoped_fields_v22": {
    "description": "v2.2 scoped field extraction test vectors",
    "vectors": [
      {
        "id": "scope-001",
        "description": "Extract single field",
        "payload": "{\"amount\":100,\"to\":\"acc123\",\"memo\":\"test\"}",
        "scope": ["amount"],
        "expectedExtracted": "{\"amount\":100}"
      },
      {
        "id": "scope-002",
        "description": "Extract multiple fields",
        "payload": "{\"amount\":100,\"to\":\"acc123\",\"memo\":\"test\"}",
        "scope": ["amount", "to"],
        "expectedExtracted": "{\"amount\":100,\"to\":\"acc123\"}"
      },
      {
        "id": "scope-003",
        "description": "Extract nested field",
        "payload": "{\"data\":{\"amount\":100},\"meta\":{\"ts\":123}}",
        "scope": ["data.amount"],
        "expectedExtracted": "{\"data\":{\"amount\":100}}"
      }
    ]
  },

  "error_conditions": {
    "description": "Error condition test cases",
    "vectors": [
      {
        "id": "err-001",
        "description": "Invalid JSON",
        "input": "{invalid}",
        "expectedError": "ASH_CANONICALIZATION_ERROR"
      },
      {
        "id": "err-002",
        "description": "Empty method",
        "method": "",
        "path": "/api",
        "query": "",
        "expectedError": "Method cannot be empty"
      },
      {
        "id": "err-003",
        "description": "Path without leading slash",
        "method": "GET",
        "path": "api/users",
        "query": "",
        "expectedError": "Path must start with /"
      }
    ]
  },

  "metadata": {
    "generatedAt": "2026-01-28T00:00:00Z",
    "ashVersion": "2.3.3",
    "maintainer": "3maem Co. | ÿ¥ÿ±ŸÉÿ© ÿπŸÖÿßÿ¶ŸÖ",
    "usage": "Run these test vectors against each SDK to verify cross-platform compatibility"
  }
}
